<!DOCTYPE html>
<html>
  <head>
    <!-- meta -->
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0">
<link rel="stylesheet" type="text/css" href="/css/common.css">

<title>配列について理解する - PerlゼミのLinux入門</title>
<meta name="description" content="C言語の配列について理解しましょう。Perlの配列は、動的な配列です。つまり、配列の大きさを気にせずに、要素を追加することができます。一方C言語の配列は、固定された大きさを持ちます。">
  </head>
  <body>
    <div class="container">
      <div class="header">
        <!-- header -->
<h1>
  <a href="/">PerlゼミのLinux入門</a>
</h1>

      </div>
      <div class="main">
        <div class="content">
          <div class="entry">
  <div class="top">
    <!-- top -->

  </div>
  <div class="middle">
    <h2><a href="/blog/20190812182939.html">配列について理解する</a></h2>
<p>
  　C言語の<b>配列</b>について理解しましょう。Perlの配列は、動的な配列です。つまり、配列の大きさを気にせずに、要素を追加することができます。一方C言語の配列は、固定された大きさを持ちます。
</p>
<p>
  ##配列の宣言と初期化
</p>
<p>
  　配列の宣言は次のように行います。
</p>
<p>
  ```
</p>
<p>
  型名 変数名[サイズ];
</p>
<p>
  ```
</p>
<p>
  　実際の配列の宣言です。
</p>
<p>
  ```c:
</p>
<p>
  /* 配列の宣言 */
</p>
<p>
  int nums[3];
</p>
<p>
  double nums[3];
</p>
<p>
  char nums[3];
</p>
<p>
  ```
</p>
<p>
  　3つのサイズしか持たないので、3つの値しか代入することができません。サイズを増やすこともできません。
</p>
<p>
  　<b>{}</b>を使って初期化を同時に行うこともできます。
</p>
<p>
  ```c:
</p>
<p>
  /* 配列の初期化 */
</p>
<p>
  int nums[3] = {1, 2, 3};
</p>
<p>
  double nums[3] = {1.5, 2.4, 6.5};
</p>
<p>
  char nums[3] = {'a', 'b', 'c'};
</p>
<p>
  ```
</p>
<p>
  ##配列のループ
</p>
<p>
  　配列をループしてみましょう。配列の個数は自分で管理する必要があります。Perlのlengthのように配列の長さを取り出すことはできません。
</p>
<p>
  ```c:
</p>
<p>
  int nums[3] = {1, 2, 3};
</p>
<p>
  int i;
</p>
<p>
  for (i = 0; i < 3; i++) {
</p>
  printf("%d\n", nums[i]);
<p>
  }
</p>
<p>
  ```
</p>
<p>
  ##よくある質問
</p>
<p>
  ###解説では、配列の要素数がべた書きされて「3」という数字が二回でてきていますが、回避できませんか。
</p>
<p>
  　C言語では、変数を使って、配列のサイズを指定することができません。マクロを使って定数を定義することで回避できます。C言語は、いろいろやろうとすると読みづらくなっていきますけどね。
</p>
<p>
  ```c:
</p>
<p>
  # define NUMS_COUNT 3
</p>
<p>
  int nums[NUMS_COUNT] = {1, 2, 3};
</p>
<p>
  int i;
</p>
<p>
  for (i = 0; i < NUMS_COUNT; i++) {
</p>
  printf("%d\n", nums[i]);
<p>
  }
</p>
<p>
  ```
</p>
<p>
  　けれども、通常は動的な配列を作成すると思います。以下で解説しています。
</p>
<p>
  ###Perlのような動的な配列をC言語ではどのように作成すればよいですか
</p>
<p>
  　C言語では、動的な配列を扱うテクニックは、別にあります。そのためには、「メモリを動的に確保する方法」と、「ポインタの知識」が必要になります。詳しいことは、動的配列の項目で解説したいと思いますが、サンプルを記述しておきます。
</p>
<p>
  ```c:
</p>
<p>
  /* intのポインタ型の宣言 */
</p>
<p>
  int* nums;
</p>
<p>
  /* int型を3個格納できるメモリを動的に確保 */
</p>
<p>
  nums = (int*)malloc(sizeof(int) * 3);
</p>
<p>
  /* 要素に代入 */
</p>
<p>
  nums[0] = 1;
</p>
<p>
  nums[1] = 2;
</p>
<p>
  nums[2] = 3;
</p>
<p>
  /* 確保したメモリの解放 */
</p>
<p>
  free(nums);
</p>
<p>
  ```
</p>
<p>
  ###上記の方法で、動的な配列のメモリを一度に確保できることはわかりますが、push,pop,shift,unshiftなどの操作はどのように行いますか。
</p>
<p>
  　Perlの配列は、動的配列で、push,pop,shift,unshift、サイズの拡張などが簡単に行えますが、C言語だけの機能ではこれを行うのは、大変めんどうです。自分で、双方向連結リストというデータ構造を自作することが必要です。
</p>
<p>
  　もし、便利なデータのコンテナが必要なのであれば、C++を使うのが、現実的な解決策になると思います。C++のstd::vectorというクラスを利用すれば、Perlによく似た動的な配列が作成できます。
</p>
<p>
  ```cpp:
</p>
<p>
  #include <vector>
</p>
<p>
  // intの動的配列
</p>
<p>
  std::vector<int> nums(3);
</p>
<p>
  // (1, 2, 3)
</p>
<p>
  nums[0] = 1;
</p>
<p>
  nums[1] = 2;
</p>
<p>
  nums[2] = 3;
</p>
<p>
  // (5, 1, 2, 3)
</p>
<p>
  nums.insert(nums.begin(), 5);
</p>
<p>
  ```
</p>
<p>
  ##サンプルコード
</p>
<p>
  　配列を使ったサンプルです。
</p>
<p>
  ```c:
</p>
<p>
  #include <stdio.h>
</p>
<p>
  int main () {
</p>
  int nums[3] = {1, 2, 3};
  
  int i;
  for (i = 0; i < 3; i++) {
    printf("%d\n", nums[i]);
  }
<p>
  }
</p>
<p>
  ```
</p>
<p>
  　実行しましょう。
</p>
<p>
  ```sh:
</p>
<p>
  gcc -o test test.c && ./test
</p>
<p>
  ```
</p>
<p>
  　実行すると以下の結果を得ることができます。
</p>
<p>
  ```
</p>
<p>
  1
</p>
<p>
  2
</p>
<p>
  3
</p>
<p>
  ```
</p>

  </div>
  <div class="bottom">
    <!-- bottom -->

  </div>
</div>

        </div>
        <div class="side">
          <!-- side -->
<div class="side-list">
  <div class="side-list-title">
    目次
  </div>
  <ul>
    <li><a href="/list.html">記事一覧</a></li>
  </ul>
</div>

        </div>
      </div>
      <div class="footer">
        <!-- footer -->
<a href="https://tutorial.perlzemi.com">Perlゼミ</a> & <a href="https://jp.giblog.net/">Giblog</a>

      </div>
    </div>
  </body>
</html>
